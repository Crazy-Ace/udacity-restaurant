<div class="header container">
  <app-cropped-image
    [src]="places.placesMeta[restaurantId]?.photo"
    class="image"></app-cropped-image>
  <div class="restaurant-meta">
    <app-star-view
      [percentage]="(places.placesMeta[restaurantId]?.rating / 5) * 100"
      class="rating"></app-star-view>
    <h1 class="meta-item title">{{places.placesMeta[restaurantId]?.name}}</h1>
    <div class="meta-item">{{places.placesMeta[restaurantId]?.phone}}</div>
    <div class="meta-item">{{places.placesMeta[restaurantId]?.vicinity}}</div>
    <div *ngIf="places.placesMeta[restaurantId]?.website" class="meta-item">
      <a tabindex="10" href="{{places.placesMeta[restaurantId]?.website}}" target="_blank">Website</a>
    </div>
    <div class="meta-item">
      <div *ngFor="let hoursString of places.placesMeta[restaurantId]?.hours" class="restaurant-hours">
        {{hoursString}}
      </div>
    </div>
    <div class="meta-item">{{places.placesMeta[restaurantId]?.types}}</div>
    <button
      pageScroll
      [pageScrollDuration]="700"
      title="This button will move you to a form to leave a review"
      (click)="reviewForm.setFocus(800)"
      href="#reviewForm"
      class="leave-review btn"
      tabindex="10">Leave a review</button>
  </div>
</div>
<div class="reviews container">
  <h2>reviews</h2>
  <div [ngClass]="{'open': showMore}" class="review-drawer">
    <div
      *ngFor="let review of places.placesMeta[restaurantId]?.reviews"
      class="review">
      <app-star-view
        [percentage]="(review.rating / 5) * 100"
        class="meta-item rating"></app-star-view>
      <div class="review-text">"{{review.text}}"</div>
      <div class="review-author">{{review.author_name}}</div>
      <div class="review-date">{{review.time | amFromUnix | amDateFormat:'M/D/YY'}}</div>
    </div>
    <div [ngClass]="{'fadeout': !showMore}"></div>
  </div>
  <button
    (click)="showMore = true"
    [ngClass]="{'hidden': showMore}"
    class="read-more btn ion-ios-arrow-down"
    tabindex="10">read more</button>
</div>
<div class="leave-a-review">
  <app-form
    *ngIf="!reviewSubmitted"
    #reviewForm
    [allFormInfo]="formInfo"
    [modeInit]="'review'"
    [tabIndex]="10"
    (formComplete)="places.addReview(restaurantId, $event); reviewSubmitted = true;"
    id="reviewForm"
    class="form"></app-form>
  <div *ngIf="reviewSubmitted">
    <h2 class="thank-you">Thank you for your review</h2>
  </div>
</div>